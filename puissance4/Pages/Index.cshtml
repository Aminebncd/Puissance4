@page
@model IndexModel
@{
    ViewData["Title"] = "Puissance 4";
}

<style>
    /* Style pour le joueur 1 (rouge) */
    .player-1 {
        background-color: red;
        color: white;
    }

    /* Style pour le joueur 2 (jaune) */
    .player-2 {
        background-color: yellow;
        color: black;
    }

    .cell {
        width: 80px;
        height: 80px;
        margin: 5px;
    }

    .round-btn {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        font-size: 24px;
    }
</style>

<h1>Puissance 4</h1>


<form method="post" asp-page="Index" id="myForm">
    <table>
        @for (int row = 0; row < 6; row++)
        {
            <tr>
                @for (int col = 0; col < 7; col++)
                {
                    <td class="cell">
                        <button asp-page-handler="DropPiece" asp-route-row="@row" asp-route-col="@col" class="round-btn @Model.GetButtonClass(row, col)" data-row="@row" data-col="@col"></button>
                    </td>
                }
            </tr>
        }
    </table>
    <input id="playerInput" type="text" style="display:none;" />

    <!-- Le bouton pour soumettre le formulaire (peut être caché) -->
    <button type="submit" style="display:none;"></button>
</form>


<table>
    @for (int row = 0; row < 6; row++)
    {
        <tr>
            @for (int col = 0; col < 7; col++)
            {
                <td class="cell">
                    <button asp-page-handler="DropPiece"
                            asp-route-row="
                            @row" asp-route-col="
                            @col" class="round-btn
                            @Model.GetButtonClass(row, col)" data-row="
                            @row" data-col="
                            @col"></button>

                </td>
            }
        </tr>
    }
</table>


<input id="playerInput" type="text" style="display:none;" />


<script>document.addEventListener('DOMContentLoaded', function () {
        const playerInput = document.getElementById('playerInput');
        console.log("playerInput:", playerInput); // Vérifiez si playerInput est trouvé

        const playerForm = playerInput.form;


        const buttons = document.querySelectorAll('.round-btn');
        buttons.forEach(function (button) {
            button.addEventListener('click', function () {
                console.log("Le bouton a été cliqué");
                const row = button.getAttribute('data-row');
                const col = button.getAttribute('data-col');
                if (playerInput) {
                    playerInput.value = row + '-' + col;
                    console.log("playerInput.value:", playerInput.value); // Affichez la valeur
                    playerInput.form.submit();
                } else {
                    console.error("Element playerInput not found.");
                }
            });
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' || e.key === 'v' || e.key === 'V') {
                const selectedButton = document.querySelector('.selected');
                if (selectedButton) {
                    selectedButton.click();
                }
            }
        });
    });</script>
